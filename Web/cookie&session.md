# [Web](https://github.com/hyojaekim/TIL/tree/master/Web) / [🏠 Home](https://github.com/hyojaekim/TIL)

### 쿠키와 세션

##### \* 사용하는 이유?

HTTP 프로토콜을 보완하기 위해서 사용한다. HTTP 프로토콜 환경에서 서버는 클라이언트가 누구인지 확인해야 한다. 이유는 connectionless, stateless한 특성이 있기 때문이다.

connectionless는 클라이언트가 요청을 하면, 서버는 요청에 맞는 응답을 보내고 접속을 끊는 특성을 말한다. 헤더에 keep-alive를 이용해 커넥션을 재활용하는데 HTTP 1.1에서는 디폴트로 설정되어 있다.

stateless는 연결을 끊는 순간 상태 정보를 유지하지 않는 특성이 있다.

따라서 쿠키와 세션은 위의 두 가지 약점을 보완하기 위해 사용한다. 만약에 쿠키와 세션이 없다면, 이동하는 페이지마다 로그인을 해야 한다.

##### \* 쿠키 (Cookie)

```
구성 요소
이름 : 쿠키를 구별하는 이름
값 : 쿠키의 이름에 해당하는 값
유효시간 : 쿠키를 유지하는 시간
도메인 : 쿠키를 전송할 도메인
경로 : 쿠키를 전송할 요청 경로
```

- 쿠키는 클라이언트의 웹 브라우저가 지정하는 메모리나 하드디스크에 저장되는 키와 값이 들어있는 작은 데이터 파일이다.
- 유효 시간을 명시하면, 브라우저를 종료해도 인증이 유지된다.
- 클라이언트에 300개까지 저장이 가능하며, 하나의 도메인당 20개의 값, 하나의 쿠키는 4KB까지 저장한다.
- 쿠키의 동작 방식
  1. 클라이언트가 페이지를 요청한다.
  2. 서버에서 쿠키 생성 후, HTTP 헤더에 포함시켜 응답
  3. 유효시간에 따라 클라이언트에서 보관
  4. 같은 요청의 경우 HTTP 헤더에 쿠키를 함께 보낸다.
  5. 서버에서 쿠키를 읽고, 상태 정보를 변경 할 필요가 있을 경우 쿠키를 업데이트 하고, 응답


##### \* 세션 (Session)

- 쿠키를 기반으로 만들어지는데 세션은 서버 측에서 관리한다.
- 서버에서 클라이언트를 구반하기 위해 세션 ID를 부여하여, 브라우저 종료까지 인증상태를 유지한다. (접속 시간에 제한을 둘 수 있음)
- 사용자의 정보를 서버에 두기 때문에 쿠키보다 안전하지만, 사용자가 많아지면 서버 메모리를 많이 차지한다. (동시접속자 수가 많은 경우, 과부하를 주게 되어서 성능 저하의 요인이 된다.)
- 세션의 동작 방식
  1. 서버는 클라이언트가 접속 시 세션 ID를 발급 해준다.
  2. 클라이언트는 세션 ID에 대해 쿠키를 사용해 저장한다.
  3. 클라이언트가 요청하면, 쿠키의 세션 ID를 서버에 전달한다.
  4. 서버는 세션 ID를 받고, 세션 ID로 세션에 있는 클라이언트 정보를 가져와 알맞는 응답을 준다.

##### \* 쿠키와 세션의 차이

- 가장 큰 차이는 저장되는 위치이다.
- 세션은 쿠키보다 보안 면에서 우수하지만, 쿠키는 세션보다 빠르다.
- 쿠키는 클라이언트에 위치해서, 스니핑 당할 우려가 있어 주로 세션 ID만 저장하도록 한다.
- 쿠키와 세션 모두 만료기간을 설정할 수 있는데 차이는 브라우저가 종료되면 세션은 만료기간에 상관없이 종료되고, 쿠키는 그대로 유지할 수 있다. (주로 쿠키와 세션의 차이를 물을 때, 저장 위치나 보안적은 부분도 좋지만, 가장 중요한 것은 라이프 사이클이다.)

##### \* 마지막으로

세션은 사용자가 늘어날수록 서버 메모리를 차지하기 때문에 이러한 문제를 해결하기 위해 토큰 기반의 인증방식을 사용하는 추세이다. 그 중에 하나가 JWT(JSON Web Token)이다.

### [맨 위로 이동](https://github.com/hyojaekim/TIL/blob/master/Web/cookie&session.md#Web---home)

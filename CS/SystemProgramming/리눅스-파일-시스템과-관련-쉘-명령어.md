# 리눅스 파일 시스템과 관련 쉘 명령어

## # 리눅스와 파일 정리

- 모든 것은 파일이라는 철학을 따른다.
    - 모든 인터렉션은 파일을 읽고 쓰는 것처럼 이루어져 있다.
    - 모든 자원에 대한 추상화 인터페이스로 파일 인터페이스를 활용

## # 슈퍼블록, inode와 파일

### 슈퍼블록

- 파일 시스템 정보

### 파일

- inode 고유값과 자료구조에 의해 주요 정보를 관리한다.
    - 파일 이름: inode로 파일 이름은 inode 번호와 매칭
    - 파일 시스템에서는 inode를 기반으로 파일 엑세스
    - inode 기반 메타 데이터 저장

### 리눅스 파일 탐색

- ex) `/home/ubuntu/link.txt`
- 각 디렉토리 엔트리를 탐색한다. (엔트리는 해당 디렉토리 파일/디렉토리 정보를 가지고 있다)
- `/` `dentry`에서 `home`을 찾고 `home`에서 `ubuntu`를 찾고, `ubuntu`에서 `link.txt` 파일 이름에 해당하는 inode를 얻는다.

### 하드 링크

- `cp` (copy의 약자) : **파일 복사**
    - 1MB 사이즈를 가지고 있는 A파일을 B파일로 복사
    - cp A B → A & B는 각각 물리적으로 10MB 파일로 저장
    - ex) `cp link.txt link3.txt` : link.txt 파일을 link3.txt로 복사
    - ex) `cp -rf main/ main2` : 하위 파일까지 모두 복사
- `rm` (remove의 약자)
    - ex) `rm link3.txt`
    - ex) `rm -rf main2`
- 하드 링크 : `ln A B` (윈도우의 바로가기와 비슷함)

    ![리눅스 파일 시스템과 관련 쉘 명령어(1)](./img/리눅스-파일-시스템과-관련-쉘-명령어(1).png)

    - A & B는 동일한 10MB 파일을 가리킴
    - 즉, 동일한 파일을 가진 이름을 하나 더 만든 것일 뿐
        - inode는 동일, 전체 파일 용량은 달라지지 않는다.
- cp & ln inode 차이

    ![리눅스 파일 시스템과 관련 쉘 명령어(2)](./img/리눅스-파일-시스템과-관련-쉘-명령어(2).png)

    - `ls -i`로 확인하면 `cp`는 inode가 다르고, `ln`(하드 링크)는 inode가 같다.
    - `ls -al`로  확인하면 용량이 같은 것을 볼 수 있다.
    - `rm A`로 삭제하면 B는 해당 파일에 접근이 가능하다. 왜냐하면 inode 정보만 삭제되고 실제 inode는 남아있기 때문이다. 즉, A는 해당 inode를 참조하지 않고, B는 그대로 참조하고 있기 때문이다.

### 소프트 링크

- 소프트(심볼릭) 링크: `ln -s A B`
    - Windows의 바로가기와 동일하다.
    - ls -al로 파일 권한을 보면 `l`이 있는데 소프트 링크를 뜻함, 그리고 `→` 로 원본 파일이 무엇인지 볼 수 있다.
    - rm A로 삭제하면, B는 해당 파일 접근이 불가능하다.
    - 원본과 inode 값이 다르다.

### 특수 파일

- 디바이스
    - `블록 디바이스(Block Device)` : HDD, CD/DVD와 같이 블록 또는 섹터 등 정해진 단위로 데이터 전송, IO 송수신 속도가 높다.
    - `캐릭터 디바이스(Character Device)` : 키보드, 마우스 등 바이트 단위 데이터 전송, IO 송수신 속도가 낮다.
    - `cd/dev`, `cat tty`
